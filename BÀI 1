--Bài 1/1
DECLARE @THONGKE TABLE (PHG INT,LTB FLOAT);
INSERT INTO @THONGKE
	SELECT PHG, AVG(Luong) AS LTB FROM NHANVIEN GROUP BY PHG;
SELECT TENNV,LUONG,'Tinh Trang'=IIF(LUONG> b.LTB,'Khong tang luong','Tang luong')
	FROM NHANVIEN A INNER JOIN @THONGKE b ON a.PHG=b.PHG;
SELECT TENNV,LUONG,'Tinh Trang'=IIF(LUONG> b.LTB,'Khong tang luong','Tang luong')
	FROM NHANVIEN A INNER JOIN (SELECT PHG, AVG(Luong) AS LTB FROM NHANVIEN GROUP BY PHG) b on a.PHG=b.PHG;
--Bài 1/2
DECLARE @THONGKE TABLE (PHG INT,LTB FLOAT);
INSERT INTO @THONGKE
	SELECT PHG, AVG(Luong) AS LTB FROM NHANVIEN GROUP BY PHG;
SELECT TENNV,LUONG,'Chuc Vu'=IIF(Luong > b.LTB,'Truong phong','NhanVien')
	FROM NHANVIEN A INNER JOIN @THONGKE b ON a.PHG=b.PHG;
--Bài 1/3
SELECT TENNV=CASE PHAI
WHEN 'Nam'THEN 'Mr.'+[TENNV]
ELSE 'Ms.'+[TENNV]
END
FROM NHANVIEN
--Bài 1/4
SELECT TENNV,LUONG,THUE=CASE
WHEN LUONG BETWEEN 0 AND 25000 THEN LUONG*0.1
WHEN LUONG BETWEEN 25000 AND 30000 THEN LUONG*0.12
WHEN LUONG BETWEEN 30000 AND 40000 THEN LUONG*0.15
WHEN LUONG BETWEEN 40000 AND 50000 THEN LUONG*0.2
ELSE LUONG*0.25 END
FROM NHANVIEN
